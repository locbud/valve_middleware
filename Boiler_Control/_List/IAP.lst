C51 COMPILER V9.59.0.0   IAP                                                               09/25/2019 14:50:56 PAGE 1   


C51 COMPILER V9.59.0.0, COMPILATION OF MODULE IAP
OBJECT MODULE PLACED IN .\_Obj\IAP.obj
COMPILER INVOKED BY: C:\Keil_v5\C51\BIN\C51.EXE ..\Libraries\IAP.C LARGE OMF2 OPTIMIZE(8,SPEED) BROWSE INCDIR(..\Source;
                    -..\Libraries) DEFINE(MB_MT=0,Uart1=1,Uart2=0) DEBUG PRINT(..\_List\IAP.lst) OBJECT(.\_Obj\IAP.obj)

line level    source

   1          /*--------------------------------------------------------------------------
   2          * File Name          : IAP.c
   3          * Author             : SunKyung
   4          * Version            : V1.0
   5          * HomePage           : http://sunkyung.iptime.org
   6          * Date               : 09/03/2013
   7          * Description        : Sikhoon J.
   8          --------------------------------------------------------------------------*/
   9          #include "REG_MG82FG5Bxx.h"
  10          //#include "Define.H"
  11          #include "IAP.H"
  12          //--------------------------------------------------------------------------
  13          // Flash Erase One page (512 bytes)
  14          //      Function: Erase_IAP()
  15          void Erase_IAP(unsigned int IAP_Address)
  16          {
  17   1              IFADRH = IAP_Address >> 8;                                      //IAP Flash Address High Byte
  18   1              IFADRL = IAP_Address & 0xFF;                            //IAP Flash Address Low Byte
  19   1              IFMT  = 0x03;                                                           //IAP Flash Mode Table (Erase Mode)
  20   1              ISPCR = 0x80;                                                           //Enable IAP to change flash
  21   1              SCMD  = 0x46;                                                           //Trigger IAP memory
  22   1              SCMD  = 0xB9;
  23   1      }
  24          //--------------------------------------------------------------------------
  25          // Flash Write
  26          //      Function: Write_IAP()
  27          //  Write to IAP address one byte
  28          void Write_IAP(unsigned int IAP_Address, unsigned char Value)
  29          {
  30   1              IFADRH = IAP_Address >> 8;                  //IAP Flash Address High Byte
  31   1              IFADRL = IAP_Address & 0xFF;                    //IAP Flash Address Low Byte
  32   1              IFD = Value ;                               //Flash data buffer
  33   1              IFMT = 0x02 ;                               //IAP Flash Mode Table (Write Mode)
  34   1              ISPCR = 0x80 ;                              //Enable IAP to change flash
  35   1              SCMD = 0x46 ;
  36   1              SCMD = 0xB9 ;
  37   1      }
  38          //--------------------------------------------------------------------------
  39          // Flash Read
  40          //      Function: Read_IAP()
  41          //  Read one byte from IAP address
  42          unsigned char Read_IAP(unsigned int IAP_Address)
  43          {
  44   1              IFADRH = IAP_Address >> 8;                  //IAP Flash Address High Byte
  45   1              IFADRL = IAP_Address & 0xFF;                    //IAP Flash Address Low Byte
  46   1              IFMT = 0x01;                                //IAP Flash Mode Table (Read Mode)
  47   1              ISPCR = 0x80;                               //Enable IAP to change flash
  48   1              SCMD = 0x46;
  49   1              SCMD = 0xB9;
  50   1          return(IFD);                                //Return Flash data
  51   1      }
  52          //--------------------------------------------------------------------------
  53          void PageP_Write(unsigned int ad, unsigned char Dat)
  54          {
C51 COMPILER V9.59.0.0   IAP                                                               09/25/2019 14:50:56 PAGE 2   

  55   1              int i = 0;
  56   1              //---
  57   1              ISPCR   = 0x80;                 // ISPEN = 1
  58   1              IFMT    = 0x04;                 // PAGE P SFR Write
  59   1              IFADRH  = (unsigned char)(ad>>8);
  60   1              IFADRL  = (unsigned char)ad;
  61   1              IFD             = Dat;
  62   1              SCMD    = 0x46;
  63   1              SCMD    = 0xB9;
  64   1              for(i=0;i<0xFFFF;i++);  //wait XTAL circuit Stable
  65   1              for(i=0;i<0xFFFF;i++);
  66   1              IFMT    = 0x00;                 // select SFR Standby Mode
  67   1              ISPCR   = 0x00;                 // ISPEN = 0
  68   1      }
  69          //--------------------------------------------------------------------------
  70          // End of File
  71          


MODULE INFORMATION:   STATIC OVERLAYABLE
   CODE SIZE        =    136    ----
   CONSTANT SIZE    =   ----    ----
   XDATA SIZE       =   ----    ----
   PDATA SIZE       =   ----    ----
   DATA SIZE        =   ----    ----
   IDATA SIZE       =   ----    ----
   BIT SIZE         =   ----    ----
   EDATA SIZE       =   ----    ----
   HDATA SIZE       =   ----    ----
   XDATA CONST SIZE =   ----    ----
   FAR CONST SIZE   =   ----    ----
END OF MODULE INFORMATION.


C51 COMPILATION COMPLETE.  0 WARNING(S),  0 ERROR(S)
